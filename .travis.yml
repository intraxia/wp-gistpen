language: php
sudo: false
dist: trusty

php:
    - 5.6
    - 7.3

matrix:
    include:
        - name: "Front-End"
          language: node_js
          node_js: 12
          env: FRONT_END=true

branches:
    only:
        - latest
        - next
        - /^\d+\.\d+(\.\d+)?(-\S*)?$/

env:
    - WP_VERSION=latest WP_MULTISITE=0
    - WP_VERSION=latest WP_MULTISITE=1
    - WP_VERSION=5.2 WP_MULTISITE=0
    - WP_VERSION=5.2 WP_MULTISITE=1

before_script:
    - bash bin/before_script.sh

script:
    - if [[ $FRONT_END != 'true' ]]; then composer test; fi
    - if [[ $FRONT_END == 'true' ]]; then npm test; fi
